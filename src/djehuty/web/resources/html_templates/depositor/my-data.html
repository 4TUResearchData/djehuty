{% extends "layout.html" %}
{% block headers %}
<script src="/static/js/jquery-3.6.0.min.js"></script>
<script src="/static/js/jquery.dataTables.min.js"></script>
<link href="/static/css/jquery.dataTables.min.css" rel="stylesheet">
<style>
.branded-table {
    width: 100%;
    max-width: 880pt;
    border: solid 2pt #f49120;
    border-radius: .5em;
}
.branded-table thead tr { background: #f49120; border-radius: .5em .5em 0em 0em; }
.branded-table thead tr th {
    color: #000;
    text-align: left;
    padding: .5em;
    z-index: 50;
    border-top: none;
}
.branded-table thead tr th:last-child { text-align: right; }
.branded-table tbody tr td { padding: .5em; z-index: 50; }
.branded-table tbody tr:nth-child(even) { background: #fafafa; }
.branded-table tbody tr td:last-child { text-align: right; width: 130pt; }
.branded-table tbody tr td:nth-child(1) {
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
    width: 100%;
    max-width: 572pt;
}
#table-unpublished { display: none; }
#table-published { display: none; }
#table-review { display: none; }
#create-new-dataset { margin: auto; }
</style>
<script>
jQuery(document).ready(function () {
    jQuery(".hide-for-javascript").removeClass("hide-for-javascript");
    jQuery("#table-unpublished").DataTable({
        columnDefs: [{ type: 'file-size', targets: 2 },
                     { orderable: false,  targets: 4 }]
    });
    jQuery("#table-unpublished").show();
    jQuery("#table-unpublished-loader").remove();

    jQuery("#table-published").DataTable({
        columnDefs: [{ type: 'file-size', targets: 2 }]
    });
    jQuery("#table-published").show();
    jQuery("#table-published-loader").remove();

    jQuery("#table-review").DataTable({
        columnDefs: [{ type: 'file-size', targets: 2 }]
    });
    jQuery("#table-review").show();
    jQuery("#table-review-loader").remove();
});
</script>
{% endblock %}
{% block submenu %}
<ul>
  <li><a href="/my/dashboard">Dashboard</a>
  <li class="active">My Datasets
  <li class="create-button"><a href="/my/datasets/new">New dataset</a>
  <li><a href="/my/collections">My Collections</a>
  <li><a href="/my/profile">Profile</a>
</ul>
{% endblock %}
{% block body %}
<noscript>
  <p class="no-script">Sorry, this page requires JavaScript to function properly.</p>
</noscript>
<div class="hide-for-javascript">
<h1>Datasets</h1>
<h2>Drafts</h2>
{%- if draft_datasets: %}
<div id="table-unpublished-loader" class="loader"></div>
<table id="table-unpublished" class="branded-table">
  <thead>
    <tr>
      <th>Dataset</th>
      <th>Type</th>
      <th>Size</th>
      <th>Created&nbsp;at</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>{% for article in draft_datasets: %}
    <tr>
      <td><a href="/my/datasets/{{article.container_uuid}}/edit">{{article.title}}</a></td>
      <td>{{article.defined_type_name | default("undefined", False)}}</td>
      <td>{{article.storage_used}}</td>
      <td>{{article.created_date | truncate(10,False,'')}}</td>
      <td><a href="/my/datasets/{{article.container_uuid}}/delete" class="fas fa-trash-can" title="Remove"></a></td>
    </tr>
  {% endfor %}</tbody>
</table>
{%- else %}
<p>You don&apos;t have draft datasets (yet).</p>
<div class="center"><a id="create-new-dataset" href="/my/datasets/new" class="button neutral-button">Create new dataset</a></div>
{%- endif %}
{%- if review_datasets: %}
<h2>Under review</h2>
<div id="table-review-loader" class="loader"></div>
<table id="table-review" class="branded-table">
  <thead>
    <tr>
      <th>Dataset</th>
      <th>Type</th>
      <th>Size</th>
      <th>Submitted&nbsp;at</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>{% for article in review_datasets: %}
    <tr>
      <td><a href="/my/datasets/{{article.container_uuid}}/edit">{{article.title}}</a></td>
      <td>{{article.defined_type_name | default("undefined", False)}}</td>
      <td>{{article.storage_used}}</td>
      <td>{{article.review_submit_date | truncate(10,False,'')}}</td>
      <td></td>
    </tr>
  {% endfor %}</tbody>
</table>
{%- endif %}
{%- if published_datasets: %}
<h2>Published</h2>
<div id="table-published-loader" class="loader"></div>
<table id="table-published" class="branded-table">
  <thead>
    <tr>
      <th>Dataset</th>
      <th>Type</th>
      <th>Size</th>
      <th>Created&nbsp;at</th>
    </tr>
  </thead>
  <tbody>{% for article in published_datasets: %}
    <tr>
       <td><a href="/my/datasets/{{article.dataset_uuid}}/edit">{{article.title}}</a></td>
      <td>{{article.defined_type_name | default("undefined", False)}}</td>
      <td>{{article.storage_used}}</td>
      <td>{{article.created_date | truncate(10,False,'')}}</td>
    </tr>
  {% endfor %}</tbody>
</table>
{%- endif %}
</div>
</div>
{% endblock %}
