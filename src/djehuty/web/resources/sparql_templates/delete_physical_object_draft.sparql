{% extends "prefixes.sparql" %}
{% block query %}
DELETE {
  GRAPH <{{state_graph}}> {
    ?physical_object  ?predicate       ?object .
    ?list             djht:index       ?list_index .
    ?list             ?any             ?list_item .

    ?container        djht:draft       ?physical_object .
  }
}
WHERE {
  GRAPH <{{state_graph}}> {
    ?container    rdf:type         djht:PhysicalObjectContainer ;
                  djht:account     <account:{{account_uuid}}> ;
                  djht:draft       ?physical_object .

    ?physical_object   ?predicate           ?object .
    OPTIONAL {
      ?object ?list_predicate      ?list .
      ?list   rdf:type             rdf:List ;
              djht:index           ?list_index ;
              rdf:rest*/rdf:first  ?list_item .
    }
  }

  FILTER (?physical_object = <physical-object:{{object_uuid}}>)
}
{% endblock %}
